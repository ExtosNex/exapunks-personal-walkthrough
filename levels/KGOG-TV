;This could probably be optimized more
;but am too lazy to cuz this took like 1.5 hours


XA:

GRAB 300
LINK 800
LINK 799
LINK 800

;AZIM
SEEK 1
COPY F X
;FIND DIFFERENCE BETWEEN
;CURRENT AZIM AND CUSTOM
SUBI X #AZIM X

;TEST INCREMENTS
TEST X > 0
TJMP POS_A ;POSITIVE INC
;IF FAIL INCREMENT BY
;NEGATIVES
MARK NEG_A
COPY -1 #MOTR
ADDI X 1 X
TEST X = 0
FJMP NEG_A
JUMP ELEV
MARK POS_A
COPY 1 #MOTR
SUBI X 1 X
TEST X = 0
FJMP POS_A



;CHANGE ELEVATION
MARK ELEV
LINK -1
LINK 801
SEEK 1
COPY F X
;FIND DIFFERENCE BETWEEN
;CURRENT FREQ AND CUSTOM
SUBI X #ELEV X

;TEST INCREMENTS
TEST X > 0
TJMP POS_E ;POSITIVE INC
;IF FAIL INCREMENT BY
;NEGATIVES
MARK NEG_E
COPY -1 #MOTR
ADDI X 1 X
TEST X = 0
FJMP NEG_E
JUMP FREQ
MARK POS_E
COPY 1 #MOTR
SUBI X 1 X
TEST X = 0
FJMP POS_E

MARK FREQ
LINK -1
SEEK 1
COPY F #FREQ
WIPE



XB:
MODE
;TRANSMIT KEY
REPL GRAB

GRAB 301
VOID F


;ENCRYPTION ALGORITHM
MARK ENCRYPT
;GET THE 3 DIGITS & ADD
SWIZ F 321 X
ADDI X M X
;EXTRACT 4TH DIGIT
;WE WILL REPEAT STEP

SWIZ X 4 X
;GET 4TH DIGITS AND ADD
SEEK -1
SWIZ F 4 T
ADDI X T X
ADDI M X X

;GRAB 1ST DIGIT AND
;YOINK IT IN
SWIZ X 1 X
MULI X 1000 T
;4TH DIGIT KEPT IN T VAR


;GET THE 3 DIGITS & ADD
SEEK -1
SWIZ F 321 X
ADDI X M X
SWIZ X 321 X ;EXTRACT 3D

;ADD 4TH DIG AND APPEND
SEEK -1
ADDI X T F




TEST EOF
FJMP ENCRYPT
;TRUE JUMP TRANSMIT
KILL
REPL CLEANER
LINK 800
LINK 799

SEEK -9999
MARK READ
COPY F #DATA
TEST EOF
FJMP READ
WIPE
HALT



MARK GRAB
LINK 800
GRAB 199
LINK -1
MARK SEND
COPY F X
SWIZ X 321 M ;SEND 3 DIG
SWIZ X 4 M ;SEND 4TH DIG
SWIZ X 321 M ;SEND 3 DIG
TEST EOF
FJMP SEND
SEEK -9999
JUMP SEND

MARK CLEANER
GRAB 199
LINK 800
